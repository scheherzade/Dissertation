\documentclass[12pt,letterpaper]{lsuetd}
\usepackage{setspace,graphics,dsfont,verbatim,paralist,indentfirst}
%bcb
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{xspace}
\usepackage{booktabs}


%bibm
\usepackage{lipsum}
\usepackage{caption}
\usepackage{algorithm,algorithmic}
\usepackage{multicol}
\usepackage{array}
\usepackage{eqparbox}
%icdcs
\usepackage{url}
\usepackage{graphicx}
%\usepackage{subcaption}
\usepackage{xcolor}
\usepackage{pgfplotstable}
%\usepackage{filecontents}
\pgfplotsset{compat=1.16}
\usepackage{fancyhdr}
\usepackage{pifont}
\newcommand{\xmark}{\ding{55}}
\DeclareMathOperator{\EX}{\mathbb{E}}
\usepackage{listings}
\usepackage{array}
\definecolor{blue-main}{rgb}{0,0,1}
\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}
\lstset{ %
	language=C++,                % the language of the code
	basicstyle=\tiny,  % the size of the fonts that are used for the code
	showspaces=false,            % show spaces adding particular underscores
	showstringspaces=false,      % underline spaces within strings
	showtabs=false,              % show tabs within strings adding particular underscores
	frame=topline,               % adds a frame around the code
	tabsize=2,                   % sets default tabsize to 2 spaces
	captionpos=t,                % sets the cap%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%tion-position to bottom
	breaklines=true,                % sets automatic line breaking
	breakatwhitespace=false,        % sets if automatic breaks should only happen at whitespace
	xleftmargin=\fboxsep,
	xrightmargin=-\fboxsep,
	firstnumber=1,
	title=\lstname,                   % show the filename of files included with \lstinputlisting;
	keywordstyle=\color{blue-main},          % keyword style
	commentstyle=\color{dkgreen},       % comment style
	stringstyle=\color{mauve},         % string literal style
	escapeinside={\%*}{*)},            % if you want to add a comment within your code
	morekeywords={*,...},               % if you want to add more keywords to the set
	escapechar={@},
	numbers=left,
	numbersep=5pt,                   % how far the line-numbers are from the code
	numberstyle=\tiny\color{gray}, % the style that is used for the line-numbers
	moredelim=**[is][\color{blue-main}]{^}{^}
}

\captionsetup[table]{labelsep=period}
\captionsetup[figure]{labelsep=period}

\usepackage{textcomp}
\usepackage{titlesec}
%\titleformat*{\section}{\normalsize\bfseries}
\titlelabel{\thetitle.\quad}
\usepackage{fourier}
\usepackage{pdfpages}
%HaRE
%\usepackage{moreverb}
%\usepackage[colorlinks,bookmarksopen,bookmarksnumbered,citecolor=red,urlcolor=red]{hyperref}
%\usepackage{floatrow}
%\usepackage{color}
%
\usepackage[strings]{underscore}
\usepackage{multirow}% http://ctan.org/pkg/multirow
\usepackage{hhline}
\usepackage{graphicx}

\setlength{\topmargin}{-0.5in}
\setlength{\textheight}{9.0in}
\addtolength{\evensidemargin}{-0.50in}
\addtolength{\oddsidemargin}{-0.50in}
\addtolength{\textwidth}{1.00in}
\setlength{\parindent}{1.75em}
\setlength{\parskip}{0ex}
\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{4}
\setcounter{section}{1}

\newcommand{\todo}[1]{}
\renewcommand{\todo}[1]{{\color{red} TODO: {#1}}}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

\makeatletter

\renewcommand\Huge{\@setfontsize\Huge{16pt}{18}} %%%%%%%%%%%%%%% Used for chapter titles
\renewcommand\huge{\@setfontsize\huge{14pt}{18}} %%%%%%%%%%%%%%% Used for chapter numbers
\renewcommand\Large{\@setfontsize\Large{12pt}{18}} %%%%%%%%%%%%%%% Used for section titles
\renewcommand\large{\@setfontsize\large{12pt}{18}} %%%%%%%%%%%%%%% Used for subsection titles
\renewcommand{\baselinestretch}{1.5}

\begin{document}
\renewcommand\@pnumwidth{1.55em}
\renewcommand\@tocrmarg{9.55em}
\renewcommand*\l@chapter{\@dottedtocline{0}{1.5em}{2.3em}}
\renewcommand*\l@figure{\@dottedtocline{1}{0em}{3.1em}}
\let\l@table\l@figure

\pagenumbering{roman}
\thispagestyle{empty}
\begin{center}
%The title page is first created.


{\Huge\bfseries
Optimizing the Performance of Multi-threaded Linear Algebra Libraries, a Task Granularity based Approach 
}\par

\vfill
\doublespacing
A Dissertation \\
\singlespacing
Submitted to the Graduate Faculty of the \\
Louisiana State University and \\
Agricultural and Mechanical College \\
in partial fulfillment of the \\
requirements for the degree of \\
Doctor of Philosophy \\
\doublespacing
in \\
                                       
Department of Electrical Engineering and Computer Science\\
\singlespacing
\vfill

by \\
Shahrzad Shirzad\\
B.Sc., Sharif University of Technology, 2006\\
M.Sc., K. N. Toosi University of Technology, 2009\\
December 2019

%If necessary, copy and paste the previous line here to include a master's degree.
\end{center}
\pagebreak
%The Copyright Page and Dedication sections can be added here, if desired.

%\chapter*{Copyright Page}
%\doublespacing
%\vspace{0.55ex}
%Insert the appropriate text for the copyright page here.
%\addcontentsline{toc}{chapter}{\hspace{-1.5em} {COPYRIGHT PAGE} \vspace{12pt}}
%\pagebreak

%\chapter*{Dedication}
%\doublespacing
%\vspace{0.55ex}
%Insert the appropriate text for the dedication or epigraph page here.  This part of the ETD must not exceed one page.
%\addcontentsline{toc}{chapter}{\hspace{-1.5em} {DEDICATION} \vspace{12pt}}
%\pagebreak

\chapter*{Acknowledgments}

%\vspace{0.55ex}


%The code below adds the Acknowledgments section to the Table of Contents.
\addcontentsline{toc}{chapter}{\hspace{-1.5em} {ACKNOWLEDGMENTS} \vspace{12pt}}
\pagebreak
%The Preface section can now be added, if desired.

%\chapter*{Preface}
%\doublespacing
%\vspace{0.55ex}
%Insert the appropriate text for the preface here.
%\addcontentsline{toc}{chapter}{\hspace{-1.5em} {PREFACE} \vspace{12pt}}
%\pagebreak
\setcounter{tocdepth}{1}
\singlespacing
\tableofcontents
\pagebreak

%The code below generates the List of Tables and adds it to the Table of Contents.
\renewcommand\@pnumwidth{1.55em}
\renewcommand\@tocrmarg{8.55em}
\addcontentsline{toc}{chapter}{\hspace{-1.5em} LIST OF TABLES \vspace{12pt}}
\listoftables
\pagebreak
%The code below generates the List of Figures and adds it to the Table of Contents.
\addcontentsline{toc}{chapter}{\hspace{-1.5em} LIST OF FIGURES \vspace{12pt}}
\listoffigures
\pagebreak
%The List of Nomenclature may be included here, if desired.

%\chapter*{List of Nomenclature}
%\doublespacing
%\vspace{0.55ex}
%Provide the definitions of the symbols used in your thesis or dissertation here.
%\addcontentsline{toc}{chapter}{\hspace{-1.5em} LIST OF NOMENCLATURE \vspace{12pt}}
%\pagebreak

%The code below adds the Abstract and places it within the Table of Contents.
\renewenvironment{abstract}{{\hspace{-2.2em} \huge \textbf{\abstractname}} \par}{\pagebreak}
\addcontentsline{toc}{chapter}{\hspace{-1.5em} ABSTRACT}
\begin{abstract}
\vspace{0.55ex}
\doublespacing

Linear algebra libraries play a very important role in HPC applications. In this work we propose a method to tune the performance of a linear algebra library based on a set of compile-time and runtime characteristics including the machine architecture, the expression being evaluated, the number of cores to run the application on, the type of the operation, and also the size of the matrices, to be able to get as close as possible to the highest performance. 

There has been an extensive amount of work and study done on how to optimize the compute kernels for matrix-matrix multiplication. In this thesis, we are interested in all types of operations, and our focus is on machine learning applications, where we are potentially dealing with very large matrices and creating temporaries could be very expensive. 

For this purpose we decided to use Blaze C++ library, a high performance template-based math library that gives us this option to access the expression tree at compile time, along with HPX, a C++ standard library for concurrency and parallelism, as our runtime system.
We propose here that instead of dividing the work equally among the cores and assigning one chunk to each core, we should be able to achieve a higher performance by selecting the right amount of work to be assigned to one core, based on a set of runtime and compile-time parameters.  

Studying the significant amount of data we collected with different configurations, we concluded that, grain size, which is the amount of work assigned to each task, is the key factor for the performance when number of cores is fixed. With this assumption, we tried two different approaches to model the relationship between performance and grain size, in order to find a range of grain size that could lead us to the maximum performance. 

First model uses a polynomial function to fit the data both for throughput vs. grain size, and throughput vs. number of cores. On the other hand, the second model was developed by studying the behavior of throughput vs. grain size , and integrating it with the an extension of the Universal Scalibility Law(USL). This developed model fitted our data reasonably and could be very important in further understanding of the parallelism. 

The primary results suggest that, using the data collected for matrix-matrix addition, we are able to improve the performance for matrix-matrix addition, by finding the right range of grain size.

Having the mentioned models, we changed the current implementation of the HPX backend for Blaze by adding two parameters to represent the unit of work and the number of these units included in each task, for fine grained control of the parallelism, which is possible through HPX runtime system.
Also, a complexity estimation function has been added to Blaze as an estimate of the number of floating point operations occurring in each unit of work. 

Our data was only limited to one specific operation, matrix-matrix addition for two raw-major matrices, one matrix size at a time. In the next step, this problem should be generalized to different matrix sizes, architectures, and arbitrary complex expressions. 

\end{abstract}

\pagenumbering{arabic}
\addtocontents{toc}{\vspace{12pt} \hspace{-1.8em} CHAPTER \vspace{-1em}}
\singlespacing
\setlength{\textfloatsep}{12pt plus 2pt minus 2pt}
\setlength{\intextsep}{6pt plus 2pt minus 2pt}
\chapter{Introduction}\label{Introduction}
\doublespacing
\input{chapter1}
\pagebreak
\singlespacing

\chapter{Background}\label{Background}
\doublespacing
\input{chapter2}
\pagebreak
\singlespacing

\chapter{Literature Review}\label{Literature}
\doublespacing
\input{chapter3}
\pagebreak
\singlespacing

\chapter{Method}\label{Method}
\doublespacing
\input{chapter4}
\pagebreak
\singlespacing

\chapter{Understanding the effect of grain size on concurrency in an asynchronous many-task runtime system}\label{Bathtub}
\doublespacing
\input{chapter5}
\pagebreak
\singlespacing

\chapter{Splittable Task}\label{splittable_task}
\doublespacing
\input{chapter6}
\pagebreak
\singlespacing

\chapter{Setup}\label{Results}
\doublespacing
\input{chapter7}
\pagebreak
\singlespacing

%\chapter{Proposed Study}\label{Future}
%\doublespacing
%\input{chapter6}
%\pagebreak
%\singlespacing

%\chapter{Appendix}
%\doublespacing
%\input{chapter7}
%\pagebreak
%\singlespacing

%To insert additional chapters, copy the previous five lines, using chapterX as the argument of the 
%\input command for Chapter X, where X=6,7,8,...
\addtocontents{toc}{\vspace{12pt}}
\addcontentsline{toc}{chapter}{\hspace{-1.6em} REFERENCES}
%\begin{thebibliography}{999}
\vspace{0.9em}
\bibliographystyle{unsrt}
\bibliography{bibliography}
%\input{bibliography}
%\end{thebibliography}


\addtocontents{toc}{\vspace{12pt} \hspace{-1.8em} APPENDIX \vspace{-1em}}
\pagebreak
\singlespacing
\appendix
%\chapter{Copyright Information}
%\vspace{0.5em}
%\input{appendixA}
%\pagebreak
%\addtocontents{toc}{\vspace{12pt} \hspace{-1.8em} APPENDIX \vspace{-1em}}
%\appendix
%\chapter{Title of Appendix A}
%\vspace{0.5em}
%\input{appendixA}
%\pagebreak
%\chapter{Title of Appendix B}
%\vspace{0.5em}
%\input{appendixB}
%\pagebreak
%If you need to insert additional appendices, copy the previous four lines, using appendixY as the
%argument of the \input commnd for Appendix Y, for Y=C,D,E,...

%Finally, the vita section is created and included in the Table of Contents.
%\chapter*{Vita}
%\doublespacing
%\setlength{\parindent}{1.75em}
%\vspace{0.2em}
%\addtocontents{toc}{\vspace{12pt}}
%\addcontentsline{toc}{chapter}{\hspace{-1.5em} VITA}
%Insert the text of your vita, which is basically a description of yourself and your academic career.
%\singlespacing
%\chapter*{Vita}
%\doublespacing
%\setlength{\parindent}{1.75em}
%\vspace{0.2em}
%\addtocontents{toc}{\vspace{12pt}}
%\addcontentsline{toc}{chapter}{\hspace{-1.5em} VITA}
%VITA
\end{document}





